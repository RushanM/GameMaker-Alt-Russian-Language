# file_ini

> Внимание! Это перевод документации неофициального расширения file_ini от YellowAfterlife. Такой статьи нет в официальной документации GameMaker и она включена сюда по причине отсутствия русской версии в оригинале, но необходимости в ней.

[*Оригинальная статья.*](https://yal.cc/docs/gm/file_ini/doc/)

---

Это «шпаргалка» по расширению файлов формата INI от YellowAfterlife.  
Расширение можно купить на [itch.io](https://yellowafterlife.itch.io/file-ini-extended-ini-functions).  

По вопросам и получения поддержки обращайтесь в [форум](https://yellowafterlife.itch.io/file-ini-extended-ini-functions/community) или [отправьте письмо](mailto://yellowafterlife@hotmail.com).

Актуальная версия этого документа всегда доступна [онлайн](https://yal.cc/r/17/file_ini/doc).

---

## Функции управления файлами INI

### file_ini_open(path, secure = false) → ini

Открывает файл по указанному пути и возвращает структуру INI (технически — массив). Это позволяет одновременно работать с несколькими файлами INI.  

* если опциональный аргумент `secure` равен `true`, используются встроенные функции `ds_map_secure_*` для загрузки/сохранения, хотя этот метод уже не считается надёжным. Рекомендуется применять [file_ini_parse](#file_ini_parse) с иным способом проверки целостности;
* если путь неправильный, файл считается пустым.

### file_ini_create() → ini

Создаёт пустой файл INI.  

* обратите внимание, что данный файл ещё не привязан к какому-либо пути, поэтому для сохранения на диск потребуется использовать функцию [file_ini_bind](#file_ini_bind).

### file_ini_parse(string) → ini

Считывает (парсит) структуру INI из переданной строки.  

* по сути, это аналог встроенной функции `ini_open_from_string`, добавленной после выпуска расширения;
* файл, созданный таким способом, не привязывается к пути, и для сохранения на диск потребуется [file_ini_bind](#file_ini_bind).

---

### file_ini_close(ini)

Записывает все несохранённые изменения на диск и уничтожает файл INI.

### file_ini_destroy(ini)

Уничтожает файл INI без сохранения внесённых изменений.

---

### file_ini_flush(ini)

Записывает все несохранённые изменения на диск, не уничтожая структуру файла INI.  

* этот метод предпочтителен для сохранения прогресса игрока, так как повторное открытие файла не потребуется.

### file_ini_print(ini) → string

Возвращает текущее состояние файла INI в виде строки, то есть то, что было бы записано на диск при закрытии или сбросе (flush).  

* если файл не привязан к пути, можно использовать связку `print` + `destroy` для получения изменённой строки и очистки структуры.

### file_ini_bind(ini, ?path, secure = false)

Изменяет путь, к которому привязан файл INI.  

* если указан аргумент `path`, меняется путь для сохранения через функции [file_ini_flush](#file_ini_flush) или [file_ini_close](#file_ini_close). В ином случае сохранение на диск отключается;
* при значении `secure` равном `true` используются встроенные функции `ds_map_secure_*` для загрузки/сохранения, что на данный момент считается неактуальным. Лучше применять [file_ini_parse](#file_ini_parse) с иным методом проверки целостности.

---

## Функции работы с секциями

### file_ini_section_exists(ini, name) → bool

Проверяет, содержит ли данная структура INI секцию с указанным названием.

### file_ini_section_delete(ini, name)

Удаляет секцию с заданным названием из структуры INI.

### file_ini_section_names(ini) → array&lt;string&gt;

Возвращает массив названий всех секций в данной структуре INI.

---

## Функции работы с парами ключ-значение

### file_ini_read_string(ini, section, key, default:string) → string

Аналог функции `ini_read_string`, но с дополнительным первым аргументом — файлом.

### file_ini_read_real(ini, section, key, default:real) → real

Аналог функции `ini_read_real`, но с дополнительным аргументом файла.

### file_ini_read_int(ini, section, key, default:int) → int

Сокращённая версия `floor(file_ini_read_real(...))`.

---

### file_ini_write_string(ini, section, key, value:string)

Аналог функции `ini_write_string`, но с первым аргументом — файлом.

### file_ini_write_real(ini, section, key, value:real)

Аналог функции `ini_write_real`, но с первым аргументом — файлом.

### file_ini_write_int(ini, section, key, value:int)

Похожа на `file_ini_write_real`, но гарантирует, что значение является целым числом.

---

### file_ini_key_exists(ini, section, key) → bool

Аналог функции `ini_key_exists`, но с первым аргументом — файлом.

### file_ini_key_delete(ini, section, key) → bool

Аналог функции `ini_key_delete`, но с первым аргументом — файлом.  

* возвращает, была ли удалена указанная пара ключ-значение.

### file_ini_key_names(ini, section, key) → array&lt;string&gt;

Возвращает массив названий ключей в указанной секции.

---

## Функции настройки

Эти функции позволяют изменить некоторые аспекты работы расширения.

### file_ini_opt_quote_keys(?force:bool) → bool

Изменяет поведение того, должны ли ключи INI заключаться в кавычки или нет.

* **выключено:**  

  ```ini
  [section]
  key=1
  ```

* **включено:**

  ```ini
  [section]
  "key"=1
  ```

При вызове без аргумента возвращает текущее значение.

### file_ini_opt_quote_values(?force:bool) → bool

Изменяет поведение того, должны ли значения INI заключаться в кавычки или нет.

* **выключено:**

  ```ini
  [section]
  key=1
  ```  

* **включено:**

  ```ini
  [section]
  key="1"
  ```  

При вызове без аргумента возвращает текущее значение.

### file_ini_opt_trailing_comments(?allow:bool) → bool

Изменяет поведение того, должны ли быть разрешены комментарии после значений INI.  

* **выключено:**

  ```ini
  [section]
  key=1 ; hello!
  ```  

* **включено:**

  ```ini
  [section]
  key=1
  ; hello!
  ```  

При вызове без аргумента возвращает текущее значение.
